DBMS:
sqlite

Error:
near "@concept_id_field": syntax error

SQL:
         SELECT 
            p.person_id AS person_id,
            t.@concept_id_field AS concept_id,
            CAST(STRFTIME('%Y', t.@date_field, 'unixepoch') AS INT) AS calendar_year,
            p.gender_concept_id AS gender_concept_id,
            FLOOR((CAST(STRFTIME('%Y', t.@date_field, 'unixepoch') AS INT) - p.year_of_birth) / 10) AS age_decile,
            MIN(CAST(STRFTIME('%Y', t.@date_field, 'unixepoch') AS INT)) AS min_calendar_year
        FROM
            @cdmDatabaseSchema.person p
        JOIN 
            @cdmDatabaseSchema.@table_name t
        ON 
            p.person_id = t.person_id
        JOIN 
            @cdmDatabaseSchema.observation_period op 
        ON 
            t.person_id = op.person_id
        AND 
            t.@date_field >= op.observation_period_start_date
        AND 
            t.@date_field <= op.observation_period_end_date
        WHERE
            t.@concept_id_field != 0
        GROUP BY
            t.@concept_id_field,
            t.person_id
        

R version:
R version 4.4.1 (2024-06-14)

Platform:
aarch64-apple-darwin20

Attached base packages:
- stats
- graphics
- grDevices
- datasets
- utils
- methods
- base

Other attached packages:
- ROMOPAPI (0.0.0.9000)
- testthat (3.2.1.1)